# 工作流名称：使用 Gradle 进行 Java 项目的持续集成
name: Java CI with Gradle

# 触发条件
on:
  # 当代码推送到 master 或 dev 分支时触发
  push:
    branches: [ "master", "dev" ]
  # 当针对 master 或 dev 分支发起拉取请求（PR）时触发
  pull_request:
    branches: [ "master", "dev" ]

# 权限设置：仅需要读取代码内容
permissions:
  contents: read

# 定义构建任务
jobs:
  build:
    # 运行环境：使用最新的 Ubuntu 环境
    runs-on: ubuntu-latest

    steps:
    # 步骤 1：拉取项目代码
    - name: Checkout repository
      uses: actions/checkout@v3
    
    # 步骤 2：设置 Java JDK 环境（根据项目要求使用 JDK 11）
    - name: Set up JDK 11
      uses: actions/setup-java@v3
      with:
        java-version: '11'          # JDK 版本
        distribution: 'temurin'     # JDK 发行版
        cache: gradle               # 开启 Gradle 依赖缓存，加快后续构建速度

    # 步骤 3：为 Gradle 包装器脚本授予执行权限
    - name: Grant execute permission for gradlew
      run: chmod +x gradlew

    # 步骤 4：运行 Gradle 构建命令（执行编译、测试和打包检查）
    - name: Build with Gradle
      run: ./gradlew build
